SELECT COUNT(*) AS ROW_COUNT, DBPARTITIONNUM(<column_name>) AS PARTITION_NUM FROM <table_schema>.<table_name> 
GROUP BY DBPARTITIONNUM(<column_name>) ORDER BY 2 WITH UR
-- to check distribution by partitions if column_name is selected in DISTRIBUTE BY HASH ("<column_name>")

SELECT TABSCHEMA, TABNAME, COLNAME, PARTKEYSEQ FROM SYSCAT.COLUMNS WHERE TABNAME='<table_name>' AND PARTKEYSEQ !=0 ORDER BY PARTKEYSEQ WITH UR    
-- to check what columns have been used in case DISTRIBUTE BY RANDOM specified, the distribution key is selected by the database manager


https://cloud.ibm.com/docs/Db2whc?topic=Db2whc-distribution_keys
https://www.ibm.com/docs/en/db2woc?topic=database-choosing-hash-distribution-key

-- example to look at an explain plan in db2 on cloud console

CREATE TABLE simple_lists(
	list_id INT GENERATED BY DEFAULT AS IDENTITY,
	list_name VARCHAR(150) NOT NULL
);

INSERT INTO 
	simple_lists (list_name) 
VALUES 
 	('ewtyrthytj'),
 	('tttttttttttt');
 
 
CREATE TABLE lists_desc (
	list_name  VARCHAR(150) NOT NULL,
	list_desc VARCHAR(150) 
);

INSERT INTO 
	lists_desc
VALUES 
 	('ewtyrthytj', 'rr'),
 	('tttttttttttt', 'tt');
	

CREATE INDEX list_desc_name
    ON lists_desc (list_name);
	
CREATE INDEX simple_lists_name
    ON simple_lists (list_name);
	
select list_id, l.list_name, list_desc from simple_lists l
inner join lists_desc d
on l.list_name = d.list_name;


-- Runstats command:
db2 runstats on table $SCHEMA.$table with distribution and detailed indexes all


-- .sh script example

typeset -u SCHEMA=$USER
DATABASE=PMHDB

#echo "\n\n"
#echo "`date` Started script $0 process id: $$ \n"

db2 connect to  $DATABASE
if (( $? != 0 ));then
	print "FATAL ERROR: Failed to connect to $DATABASE"
	exit 1
fi

db2 list tables | grep $SCHEMA|awk '{print $1}'|while read table
do

	db2  "runstats on table $SCHEMA.$table with distribution and detailed indexes all"

	if (( $? != 0 ));then
		print "Error running runstats on $table"
	fi
done

db2 terminate
